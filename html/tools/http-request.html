<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<base href="../../">
	<meta charset="utf8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<link rel="shortcut icon" href="img/pb16x16.ico" title="B_Pt">
	<link rel="stylesheet" type="text/css" href="js/bootstrap-3.3.7-dist/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="js/bootstrap-3.3.7-dist/css/bootstrap-theme.min.css">
	<link rel="stylesheet" type="text/css" href="js/syntaxhighlighter/theme.css">
	<link rel="stylesheet" type="text/css" href="css/common.css">
	<title>http请求</title>
</head>
<body>
	<!-- navitor -->
	<div class="">
		<nav class="navbar navbar-default navbar-static-top">
			<div class="container-fluid">
				<button type="button" class="btn btn-default navbar-btn navbar-right">Home</button>
			</div>
		</nav>
	</div>
	<div class="container-fluid">
		<div id="catalog" class="col-lg-2"></div>
		<div class="col-lg-8">
			<div class="container-fluid">
				<ol class="breadcrumb">
					<li><a href="mainpage.html">Home</a></li>
					<li><a href="#">tool</a></li>
					<li class="active"></li>
				</ol>
			</div>
			<div class="container">
				<div class="page-header">
					<h3>http请求</h3>
					<small>2017-12-14</small>
				</div>
				<div class="bg-gray">
					<p><em></em></p>
				</div>
				<div class="centent">
					<form class="form-inline">
						<div class="form-group">
							<select id="method" class="form-control">
							  <option value="post">POST</option>
							  <option value="get">GET</option>
							</select>
							<input type="text" class="form-control" style="width: 700px;" id="url" placeholder="HTTP://">
							<input class="btn btn-default" type="button" onclick="send()" value="SEND">
						</div>
						<div>
							<table class="table table-bordered" id="headers">
								<thead>
									<th>HEADER</th><th>VALUE</th>
								</thead>
								<tbody>
									
								</tbody>
								<tfoot>
									<tr>
										<td colspan="2">
											<input class="btn btn-default" type="button" value="添加HEADER" onclick="addParams('headers');">
										</td>
										
									</tr>
								</tfoot>
							</table>
						</div>
						
						<div>
							<table class="table table-bordered" id="bodys">
								<thead>
									<th>BODY</th><th>VALUE</th>
								</thead>
								<tbody>
									
								</tbody>
								<tfoot>
									<tr>
										<td colspan="2">
											<input class="btn btn-default" type="button" value="添加BODY" onclick="addParams('bodys');">
										</td>
									</tr>
								</tfoot>
							</table>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="container">
		<div class="footer text-center">
			<hr style="height:1px;border:none;border-top:1px solid #555555;" />
			<em>The world is so interesting</em>
		</div>
	</div>
	<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="js/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
    	<script type="text/javascript" src="js/syntaxhighlighter/syntaxhighlighter.js"></script>
	<script>
		var tr = '<tr>'
			+'<td>'
			+'<input type="text" class="form-control" placeholder="name">'
			+'</td>'
			+'<td>'
			+'<input type="text" class="form-control" placeholder="value">'
			+'<input class="btn btn-default" type="button" value="删除" onclick="deleteTr(this)">'
			+'</td></tr>';
		function addParams(id){
			var tbl = $("#"+id+" tbody");
			tbl.append(tr);
		}
		
		function deleteTr(item){
			$(item).parent().parent().remove();
		}
		
		function send(){
			var method = $("#method").val();
			var url = $("#url").val();
			if(url == null || url.trim() == "")return;
			var headerInputs = $("#headers input.form-control");
			var headers = {};
			for(let i=0;i < headerInputs.length; i+=2){
				var key = $(headerInputs[i]).val().trim();
				if(key == '')continue;
				var value = $(headerInputs[i + 1]).val().trim();
				if(value == '')continue;
				headers[key] = value;
				console.log(key+":"+value);
			}
			
			var bodyInputs = $("#bodys input.form-control");
			var bodys = {};
			for(let i=0;i < bodyInputs.length; i+=2){
				var key = $(bodyInputs[i]).val().trim();
				if(key == '')continue;
				var value = $(bodyInputs[i + 1]).val().trim();
				if(value == '')continue;
				bodys[key] = value;
				console.log(key+":"+value);
			}
			$.ajax({
				type:method,
				url:url,
				async:true,
				data:bodys,
				beforeSend:function(xhr){
					$.each(headers,function(k,v){
						xhr.setRequestHeader(k,v);
					})
				},
				success:function(result){
					console.log(result)
				}
			});
			
		}
	</script>
</body>
</html>
